#!/usr/bin/env python3

import requests

def brute_force(url,diretorios):
    for diretorio in diretorios:
        url_alvo = f"{url}/{diretorio}/"
        resposta = requests.get(url_alvo)
    
        if resposta.status_code == 200:
           print(f"Novo diretorio encontrado [+]{diretorio}[+] - URL {url_alvo}")
           with open("brute_force.txt","a") as file:
                file.write(f"{url_alvo}")
        elif 300 <= resposta.status_code < 400:
           print(f"Ocorreu um redirecionamento no Diretorio {diretorio} - URL {url_alvo}")
           with open("brute_force.txt","a") as file:
                file.write(f"{url_alvo}")
        else:
            pass

if __name__ == "__main__":

     with open("urls.txt","r") as arquivo_urls:
          urls = arquivo_urls.read().splitlines()

     with open("diretorios.txt","r") as arquivo_diretorio:
          diretorios = arquivo_diretorio.read().splitlines()
          
     for url in urls:
         print(f"Realizando o Brute Force no site {url}")
         brute_force(url,diretorios)
         
